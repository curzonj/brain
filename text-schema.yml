description: "represents a range of types of things including: concepts, entities, topics"
type: object
additionalProperties: false
properties:
  _id:
    type: string
  _rev:
    type: string
  what:
    description: a concrete independent topic
    type: string
  aka:
    type: array
    items:
      type: string
  related:
    $ref: "#/definitions/related"
  links:
    $ref: "#/definitions/links"
  books:
    $ref: "#/definitions/books"
  todo:
    type: array
    items:
      oneOf:
        - type: string
        - type: object
          additionalProperties: false
          properties:
            text:
              type: string
            related:
              type: string
  thoughts:
    $ref: "#/definitions/plainTextList"
  sections:
    $ref: "#/definitions/sectionList"
  queue:
    type: array
    items:
      type: string
definitions:
  related:
    oneOf:
      - type: string
      - type: array
        items:
          type: string
  books:
    type: array
    items:
      oneOf:
        - type: string
        - $ref: "#/definitions/externalReference"
  links:
    type: array
    items:
      oneOf:
        - type: string
          pattern: "^https?://"
        - $ref: "#/definitions/externalReference"
  src:
    oneOf:
      - description: If it doesn't start with http it's a noun/author
        type: string
      - $ref: "#/definitions/externalReference"
  externalReference:
    oneOf:
      - type: object
        additionalProperties: false
        properties:
          book:
            string: string
          chapter:
            string: string
          page:
            string: string
          link:
            type: string
          title:
            type: string
          comment:
            type: string
          author:
            type: string
      - type: object
        additionalProperties: false
        properties:
          search:
            type: string
          site:
            type: string
  sectionList:
    type: array
    items:
      type: object
      additionalProperties: false
      properties:
        about:
          type: string
        list_of:
          description: refers to topics or list. Thoughts and related are always just that.
          type: string
        related:
          $ref: "#/definitions/related"
        links:
          $ref: "#/definitions/links"
        books:
          $ref: "#/definitions/books"
        topics:
          description: plain strings are anchors
          $ref: "#/definitions/plainTextList"
        list:
          description: plain strings are just strings
          $ref: "#/definitions/plainTextList"
        thoughts:
          $ref: "#/definitions/plainTextList"
  plainTextList:
    type: array
    items:
      $ref: "#/definitions/plainText"
  plainText:
    oneOf:
      - type: string
      - $ref: "#/definitions/textObject"
  textObject:
    type: object
    additionalProperties: false
    properties:
      # plain text attributes
      text:
        type: string

      props:
        type: object
        additionalProperties: false
        required: [ quantity ]
        properties:
          # plain text attributes
          quantity:
            type: string


      # Quote attributes
      about:
        type: string
      code:
        type: string
      quote:
        type: string
      src:
        $ref: "#/definitions/src"

      # Question answer attributes
      question:
        # unenforced, but required for this type
        type: string
      answer:
        oneOf:
          - type: string
          - type: array
            items:
              type: string

      # Misc attributes
      date:
        type: string
        pattern: "^20\\d{2}-\\d{2}-\\d{2}$"
      more:
        $ref: "#/definitions/plainTextList"
      related:
        description: related to the comment itself
        $ref: "#/definitions/related"
      links:
        $ref: "#/definitions/links"
