(window.webpackJsonpkbase=window.webpackJsonpkbase||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){},154:function(e,t){},156:function(e,t){},173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(80),i=n.n(c),u=(n(103),n(8)),s=n(14),o=(n(104),n(105),function(e){return a.a.createElement("div",null,a.a.createElement("ul",{className:"menu"},e.children,a.a.createElement("li",{style:{float:"left"}},a.a.createElement(u.b,{to:"/menu"},"menu"))),a.a.createElement("div",{style:{clear:"both"}}))});function f(e){return a.a.createElement("div",{className:"header"},a.a.createElement("h1",{className:"title"},e.title))}var p=n(11),l=n(0),h=n.n(l),d=n(2),b=n(84),v=n(96),x=n(5),m=n(24),w=n(18),k=n(33),y=n(23),g=n(97),O=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Object(x.a)(this,t),(e instanceof Error||"string"!==typeof e&&e.message)&&(r.cause=e,e=r.cause.message),(n=Object(m.a)(this,Object(w.a)(t).call(this,e))).details=void 0,n.cause=void 0,n.name=n.constructor.name,r.cause&&(n.cause=r.cause,r.cause.name&&(n.name=r.cause.name),delete r.cause),r.stack&&n.stack){r.stack instanceof Error&&(r.stack=r.stack.stack);var a=r.stack.split("\n").slice(1),c=n.stack.split("\n")[0];delete r.stack,n.stack=[c].concat(Object(v.a)(a)).join("\n")}else Error.captureStackTrace&&Error.captureStackTrace(Object(k.a)(n),n.constructor);for(var i in n.details=function e(t){if(!t)return{};var n=e(t.cause);if(t.details)for(var r in t.details)n[r]||(n[r]=t.details[r]);return n}(n.cause),r)n.details[i]||(n.details[i]=r[i]);return n}return Object(y.a)(t,e),t}(Object(g.a)(Error));function j(e,t){return E.apply(this,arguments)}function E(){return(E=Object(d.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n().catch((function(e){throw e instanceof O||(e=new O(e,t)),e})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Promise.resolve().then(e).catch((function(e){return _(e,t)}))}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e instanceof O?Object.assign(e.details,t):e=new O(e,t),console.error(e),e.cause&&e.cause.stack&&console.log(e.cause.stack),console.log(e.details)}var S=n(83),D=n(21),N={warning:Object(D.debug)("kbase:warning"),events:Object(D.debug)("kbase:events"),network:Object(D.debug)("kbase:network"),storage:Object(D.debug)("kbase:storage"),performance:{timing:Object(D.debug)("kbase:performance:timing"),profiling:Object(D.debug)("kbase:performance:profiling")},uiEvents:Object(D.debug)("kbase:uievents"),trace:Object(D.debug)("kbase:trace")};function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fuzzy:!1,wait:200,leading:!0};var a=n.wait,c=n.fuzzy,i=Object(r.useState)({fn:Object(S.debounce)((function(e,n){P(Object(d.a)(h.a.mark((function r(){return h.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=n,r.next=3,t(e,n);case 3:r.t1=r.sent,(0,r.t0)(r.t1);case 5:case"end":return r.stop()}}),r)}))))}),a,n)}),u=Object(p.a)(i,2),s=u[0],o=u[1],f=s.fn,l=c?s.result:void 0;if(Object(r.useEffect)((function(){var t=!0;return f.cancel(),f(e,(function(n){if(t&&n){var r=!!l&&Object(b.deepEqual)(n,l);N.trace("useAsync params=%O result=%O changed=%o",e,n,!r),r||o({fn:f,params:e,result:n})}})),function(){t=!1}}),[f,e,l]),c||s.params===e)return s.result}var A=n(34),B=n(85),L=n(86),z=n.n(L);function q(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(e).flatMap((function(t){return[e[t]].flat().filter(W)}))}function W(e){return void 0!==e&&("string"!==typeof e&&"string"===typeof e.ref)}function C(e,t){return T.apply(this,arguments)}function T(){return(T=Object(d.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N.performance.profiling.enabled){e.next=2;break}return e.abrupt("return",n());case 2:return console.profile?console.profile(t):console.time&&console.time(t),e.next=5,n();case 5:return r=e.sent,console.profileEnd?console.profileEnd(t):console.timeEnd&&console.timeEnd(t),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.printTiming=function(){var e=performance.getEntriesByName("measure");console.dir(e)};var R=n(10),F=function(){function e(){var t=this;Object(x.a)(this,e),this.listeners=[],this.listenersOncer=[],this.on=function(e){return t.listeners.push(e),{dispose:function(){return t.off(e)}}},this.once=function(e){t.listenersOncer.push(e)},this.off=function(e){var n=t.listeners.indexOf(e);n>-1&&t.listeners.splice(n,1)},this.emit=function(e){return t.emitBoth(void 0,e)},this.error=function(e){return t.emitBoth(e,void 0)}}return Object(R.a)(e,[{key:"emitBoth",value:function(e,t){if(this.listeners.forEach((function(n){return n(e,t)})),this.listenersOncer.length>0){var n=this.listenersOncer;this.listenersOncer=[],n.forEach((function(n){return n(e,t)}))}}}]),e}();function U(e,t,n){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(h.a.mark((function e(t,n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(r));case 2:return e.next=4,new Promise((function(e,a){var c=t[Symbol.iterator](),i=0,u=0,s=!1;function o(){var n=c.next(),o=n.value;if(n.done)return s=!0,void(u<=0&&e());var p=i+1;i+=1,u+=1,P(Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(o,p,t).finally((function(){u-=1})).then((function(){f()})).catch((function(e){s=!0,a(e)})));case 1:case"end":return e.stop()}}),e)}))))}function f(){for(;u<n&&!s;)o();s&&u<=0&&e()}f()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J="$/topics/",K="$/topics/\ufff0";function V(e){return e?e.title||e.link||"Note":"Missing Page"}function $(e,t){var n=e.metadata,r=t.metadata;return n&&n.created_at&&r&&r.created_at?n.created_at>r.created_at?-1:n.created_at<r.created_at?1:0:(N.warning("invalid payloads: %O %O",e,t),0)}function G(e,t){return e.ref?t.ref?e.ref<t.ref?-1:e.ref>t.ref?1:0:1:-1}function H(e,t){var n=t.reduce((function(t,n){var r,a,c=(r=e,function(e,t){if(!e)return!1;var n=e.map((function(e){return W(e)?e.ref:e.metadata.id})),r=W(t)?t.ref:"string"===typeof t?t:t.metadata.id;return n.indexOf(r)>-1}((a=n.topic).actionOn,r)?"tasks":void 0!==a.title||W(a.src)?W(a.src)&&a.src.ref===r?"quotes":"backrefs":"notes");return(t[c]=t[c]||[]).push(n),t}),{});return n.notes&&(n.notes=n.notes.sort($)),n.tasks&&(n.tasks=function(e){var t=[],n=e.find((function(e){return e.metadata.firstAction}));n&&function e(t,n,r){t.push(n);var a=n.metadata.nextAction;if(a){var c=r.find((function(e){return e.metadata.id===a.ref}));if(!c)return;e(t,c,r)}}(t,n,e);return e.forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),t}(n.tasks)),n}function Q(e){return X.apply(this,arguments)}function X(){return(X=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.configs.get("lastSeq").catch((function(e){}));case 2:return n=e.sent,N.storage("lastSeq=%s",n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,n){return Z.apply(this,arguments)}function Z(){return(Z=Object(d.a)(h.a.mark((function e(t,n,r){var a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){var e=Object(d.a)(h.a.mark((function e(r){var a,c,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.changes({include_docs:!0,since:r,limit:200,batch_size:200});case 2:return a=e.sent,c=a.last_seq,i=a.results,N.network("pouchdb.changes count=%s seq=%s",i.length,c),e.next=8,U(i,30,function(){var e=Object(d.a)(h.a.mark((function e(n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r%100===0&&N.storage("topics.putOrDel progress=%s",r),!n.deleted){e.next=6;break}return e.next=4,t.topics.del(ae(n.id));case 4:e.next=9;break;case 6:if(!n.doc||!n.doc.metadata){e.next=9;break}return e.next=9,t.topics.put(ae(n.id),n.doc);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 8:return e.next=10,t.configs.put("lastSeq",c);case 10:if(!(i.length>0)){e.next=13;break}return e.next=13,t.write();case 13:return e.abrupt("return",{results:i.length,seq:c});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(d.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.results,r=t.seq,!(n>0)){e.next=3;break}return e.abrupt("return",a(r).then(c));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",a(r).then(c));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.network("getAllDocs at=start"),e.next=3,t.allDocs({include_docs:!0,update_seq:!0,startkey:J,endkey:K});case 3:return n=e.sent,N.network("getAllDocs at=finish count=%s",n.rows.length),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t){return re.apply(this,arguments)}function re(){return(re=Object(d.a)(h.a.mark((function e(t,n){var r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(n);case 2:return r=e.sent,a=r.rows,c=r.update_seq,e.next=7,U(a,30,function(){var e=Object(d.a)(h.a.mark((function e(n,r){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=n.doc,r%100===0&&N.storage("topics.put progress=%s",r),!a){e.next=8;break}return N.trace("topics.Put at=start index=%s id=%s",r,a.metadata.id),e.next=7,t.topics.put(a.metadata.id,a,{freshIndexes:!0});case 7:N.trace("topics.Put at=finish index=%s id=%s",r,a.metadata.id);case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),_(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}());case 7:return e.next=9,t.configs.put("lastSeq",c);case 9:return e.next=11,t.write();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return(t=e,t.split("/").reverse())[0];var t}var ce=n(87),ie=n.n(ce),ue=(n(88),n(89)),se=n.n(ue),oe=n(31),fe=n.n(oe),pe=n(90),le="\xff",he=function(){function e(t,n,r){Object(x.a)(this,e),this.indexer=void 0,this.indexDb=void 0,this.base=void 0,this.base=t,this.indexDb=n,this.indexer=r}return Object(R.a)(e,[{key:"get",value:function(){var e=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getAll({gte:"".concat(t,"!"),lt:"".concat(t,"!").concat(le)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,this.indexDb.forEach(t,(function(e,t){n.push(e.split("!")[0])}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,this.forEach(t,(function(e,t){n.push(t)}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"forEach",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n){var r=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.indexDb.forEach(t,function(){var e=Object(d.a)(h.a.mark((function e(t,a){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.base.get(a);case 2:return c=e.sent,e.next=5,n(a,c);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateIndex",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n,r){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return e.next=3,this.indexDelsBatchList(t);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=this.indexPutsBatchList(t);case 7:if(!((a=e.t0).length>0)){e.next=11;break}return e.next=11,this.indexDb.batch(a,n);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"indexDelsBatchList",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var n=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=de,e.t1=t,e.t2=n.indexer,"put"!==t.type){e.next=7;break}e.t3=t.value,e.next=10;break;case 7:return e.next=9,n.base.get(t.key).catch((function(e){}));case 9:e.t3=e.sent;case 10:return e.t4=e.t3,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t4));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent.flat());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"indexPutsBatchList",value:function(e){var t=this;return e.map((function(e){return de(e,t.indexer,e.value)})).flat()}}]),e}();function de(e,t,n){return void 0===n?[]:[t(n)].flat().filter((function(e){return void 0!==e})).map((function(t){var n=[t,e.key].join("!");return"put"===e.type?{type:"put",key:n,value:e.key}:{type:"del",key:n}}))}var be=n(38);var ve=function(){function e(t,n){Object(x.a)(this,e),this.db=void 0,this.base=void 0,this.idx=void 0,this.indexed=void 0,this.base=fe()(t),this.db=fe()(Object(be.a)(this.base,"objects")),this.idx=this.buildIndexes(n),this.indexed=Object.keys(this.idx).length>0}return Object(R.a)(e,[{key:"buildIndexes",value:function(e){if(!e)return{};var t={};for(var n in e)t[n]=new he(this,this.sub("idx-".concat(n)),e[n]);return t}},{key:"updateIndexes",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n){var r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(a.length>2&&void 0!==a[2])||a[2],e.prev=1,e.next=4,Promise.all(Object.values(this.idx).map(function(){var e=Object(d.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.updateIndex(t,n,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new O("failed to update indexes for batch",{cause:e.t0,batches:t});case 9:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n){var r=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j({key:t},(function(){return r.db.get(t,n)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.indexed||r&&!0===r.freshIndexes){e.next=3;break}return e.next=3,this.updateIndexes([{type:"del",key:t}],r);case 3:return e.next=5,this.db.put(t,n,r);case 5:if(!this.indexed){e.next=8;break}return e.next=8,this.updateIndexes([{type:"put",key:t,value:n}],r,!1);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"del",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.indexed){e.next=3;break}return e.next=3,this.updateIndexes([{type:"del",key:t}],n);case 3:return e.next=5,this.db.del(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"batch",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.batch(t,n);case 2:if(!this.indexed){e.next=5;break}return e.next=5,this.updateIndexes(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"subIndexed",value:function(t){var n=this;return function(r){return new e(Object(be.a)(n.base,t),r)}}},{key:"sub",value:function(t){return new e(Object(be.a)(this.base,t),{})}},{key:"getAll",value:function(){var e=Object(d.a)(h.a.mark((function e(){var t,n,r=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},n=[],e.next=4,this.forEach(t,(function(e,t){n.push(t)}));case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"forEach",value:function(){var e=Object(d.a)(h.a.mark((function e(t,n){var r=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var c=r.db.iterator(t);!function t(){c.next((function(r,i,u){r?c.end((function(e){a(new O(r))})):i&&u?Promise.resolve().then(Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(i,u));case 1:case"end":return e.stop()}}),e)})))).then(t,a):c.end((function(t){t?a(new O(t)):e()}))}))}()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),xe=n(92),me=12,we=new pe.WordTokenizer;function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(n,!0).forEach((function(t){Object(A.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge,Oe=new function e(t){var n=this;Object(x.a)(this,e),this.name=void 0,this.payload=void 0,this.errorPayload=void 0,this.event=new F,this.hasFired=function(){return void 0!==n.payload||void 0!==n.errorPayload},this.isPending=function(){return!n.hasFired()},this.once=function(e){if(n.hasFired())return e(n.errorPayload,n.payload);n.event.once(e)},this.then=function(){var e=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){n.once((function(n,r){return n?t(n):e(r)}))})).then(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.error=function(e){if(n.hasFired())throw new Error("Rendezvous already fired");n.errorPayload=e,n.event.error(e)},this.done=function(e){if(n.hasFired())throw new Error("Rendezvous already fired");N.events("eventFired name=%s payload=%O",n.name,e),n.payload=e,n.event.emit(e)},this.name=t}("dataLoading"),je=ie()("wiki"),Ee=function(e){var t,n=Object(xe.a)(fe()(se()(e,{valueEncoding:"json"}))),r=(t=n.db,new ve(t,{})),a=function(){var e=Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.storage("batched.write at=start"),e.next=3,n.write();case 3:N.storage("batched.write at=finish");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=r.subIndexed("topics")({backrefs:function(e){return q(e.topic).map((function(e){return e.ref}))},terms:function(e){var t=e.topic;return[t.text||[],t.title||[]].flat().flatMap((function(e){return we.tokenize(e.toLowerCase())})).filter((function(e){return e.length>2&&e.match(/^[a-z]+$/)}))}}),i=r.sub("uploads");return{write:a,topics:c,configs:r.sub("configs"),uploads:i}}(je);function Pe(e){return _e.apply(this,arguments)}function _e(){return(_e=Object(d.a)(h.a.mark((function e(t){var n,r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.topic,r=t.metadata,a=q(n,!0).map((function(e){return e.ref})),e.next=4,Ee.topics.idx.backrefs.get(r.id);case 4:return c=e.sent,e.abrupt("return",c.filter((function(e){return void 0===e.metadata.stale_at})).filter((function(e){return-1===a.indexOf(e.metadata.id)})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e){return De.apply(this,arguments)}function De(){return(De=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j({topicKey:t},Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ee.topics.get(t));case 1:case"end":return e.stop()}}),e)})))).catch((function(e){if("NotFoundError"===e.name&&e.details){if(Oe.isPending())return Oe.then((function(){return Se(t)}));console.log(ye({error:e.message},e.details))}else _(e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e,t){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(d.a)(h.a.mark((function e(t,n){var r,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"index"===t&&(t="inbox"),n=n.trim(),r=z()(),a={_id:He(r),metadata:{id:r,created_at:Date.now()},topic:{broader:[{ref:t}]}},n.startsWith("http")?a.topic.link=n:a.topic.text=n,e.next=7,Ee.uploads.put(r,a);case 7:return e.next=9,Ee.topics.put(r,a);case 9:return e.next=11,Ee.write();case 11:navigator.onLine&&(c=Ke(),P(Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$e(a,c));case 1:case"end":return e.stop()}}),e)}))),{at:"data.addNote"}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(){return Be.apply(this,arguments)}function Be(){return(Be=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.onLine){e.next=2;break}return e.abrupt("return",!0);case 2:if(Ve()){e.next=5;break}return e.abrupt("return",!1);case 5:return t=Ke(),P(Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.info());case 1:case"end":return e.stop()}}),e)}))),{at:"data.isConfigured"}),e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(e){return ze.apply(this,arguments)}function ze(){return(ze=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee.uploads.forEach({},function(){var e=Object(d.a)(h.a.mark((function e(n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e(r,t);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(){return We.apply(this,arguments)}function We(){return(We=Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae();case 2:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return Ce(),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){Oe.hasFired()||(navigator.onLine?P(Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Ke(),e.next=4,Te(t);case 4:return e.next=6,Le(t);case 6:return e.prev=6,Oe.done(!0),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[0,,6,9]])}))),{at:"data.backgroundSync"}):Oe.done(!0))}function Te(e){return Re.apply(this,arguments)}function Re(){return(Re=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C("syncToLevelDB",Object(d.a)(h.a.mark((function e(){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(Ee);case 2:return n=e.sent,e.next=5,Fe();case 5:if(r=e.sent,n&&r){e.next=13;break}return e.next=9,Me();case 9:return e.next=11,ne(Ee,t);case 11:e.next=15;break;case 13:return e.next=15,Y(Ee,t,n);case 15:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee.configs.get("storageVersion").catch((function(e){}));case 2:return t=e.sent,N.storage("storageVersion=%s codeStorageVersion=%s",t,me),e.abrupt("return",t&&t>=me);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return Je.apply(this,arguments)}function Je(){return(Je=Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.storage("Resetting storage schema"),e.next=3,je.store("readwrite").clear();case 3:return e.next=5,Ee.configs.put("storageVersion",me);case 5:return e.next=7,Ee.write();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(){if(!ge){var e=Ve();if(!e)throw new Error("database configuration unavailable");ge=new B.a(e.url,e)}return ge}function Ve(){if(localStorage.couchdb_target)try{var e=JSON.parse(localStorage.couchdb_target);if(!e.url||!e.auth)throw new Error("Invalid db target config");return e}catch(t){_(t),delete localStorage.couchdb_target}}function $e(e,t){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(d.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.put(t);case 3:e.next=10;break;case 5:if(e.prev=5,e.t0=e.catch(0),409===e.t0.status){e.next=10;break}return _(e.t0),e.abrupt("return");case 10:return e.next=12,Ee.uploads.del(t.metadata.id,{writeBatch:!0});case 12:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function He(e){if(e.startsWith("/"))throw new O("invalid topicID",{topicID:e});return"$/topics/".concat(e)}var Qe=[["broader","Broader"],["related","Related"],["links","Links"]],Xe=[function(e,t){return nt.apply(this,arguments)},function(e){return rt.apply(this,arguments)},function(e,t){return vt.apply(this,arguments)}];function Ye(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=Object(d.a)(h.a.mark((function e(t,n){var r,a,c,i=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(i.length>2&&void 0!==i[2])||i[2],e.next=3,Se(t);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",n({title:t,sections:[{text:"No such topic"}]}));case 6:return c=Oe.isPending(),e.next=9,j({doc:a},Object(d.a)(h.a.mark((function e(){var t,c,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={title:V(a.topic),sections:[]},r&&n(t),e.next=4,Pe(a);case 4:return c=e.sent,i=H(a.metadata.id,c),e.next=8,Xe.reduce(function(){var e=Object(d.a)(h.a.mark((function e(c,u){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:return e.next=4,u(a,i);case 4:e.t0=e.sent,[e.t0].flat().forEach((function(e){return t.sections.push(e)})),r&&n(t);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve());case 8:r||n(t);case 9:case"end":return e.stop()}}),e)}))));case 9:if(!c){e.next=12;break}return e.next=12,Oe.then((function(){return Ye(t,n,!1)}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e){return tt.apply(this,arguments)}function tt(){return(tt=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ft(t.tasks);case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",[{heading:"Tasks",list:n}]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nt(){return(nt=Object(d.a)(h.a.mark((function e(t,n){var r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.topic,e.next=3,it(r.collection);case 3:return e.t0=e.sent,e.next=6,et(n);case 6:if(e.t1=e.sent,a=[e.t0,e.t1].flat(),r.text||0!==a.length){e.next=10;break}return e.abrupt("return",[]);case 10:return e.abrupt("return",{text:r.text,src:r.src,divs:a});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(){return(rt=Object(d.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.topic,r=t.metadata,!n.narrower){e.next=5;break}return e.abrupt("return",Promise.all(n.narrower.map(function(){var e=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se(t.ref);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",{text:"Missing ".concat(t.ref)});case 5:return e.abrupt("return",at(n.topic,(function(e){return e===r.id})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(e,t){return ct.apply(this,arguments)}function ct(){return(ct=Object(d.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j({doc:t},Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=V(t),e.t1=t.text,e.next=4,it(t.narrower||t.collection);case 4:return e.t2=e.sent,e.next=7,st(Qe,t,n);case 7:return e.t3=e.sent,e.t4=[e.t2,e.t3].flat(),e.abrupt("return",{title:e.t0,text:e.t1,divs:e.t4});case 10:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function it(e){return ut.apply(this,arguments)}function ut(){return(ut=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xt(t);case 2:return n=e.sent,e.abrupt("return",n?{list:n}:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function st(e,t,n){return ot.apply(this,arguments)}function ot(){return(ot=Object(d.a)(h.a.mark((function e(t,n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=Object(d.a)(h.a.mark((function e(t){var a,c,i,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(p.a)(t,2),c=a[0],i=a[1],e.next=3,xt(n[c],r);case 3:return u=e.sent,e.abrupt("return",u?{heading:i,list:u}:[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent.flat());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(){return pt.apply(this,arguments)}function pt(){return(pt=Object(d.a)(h.a.mark((function e(){var t,n,r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),r=0;r<t;r++)n[r]=a[r];return e.abrupt("return",Promise.all(n.filter((function(e){return Array.isArray(e)})).flat().map(yt)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lt(e,t){return ht.apply(this,arguments)}function ht(){return(ht=Object(d.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all(t.map(wt));case 4:e.t0=function(e){n.some((function(t){return t.ref===e.ref}))||n.unshift(e)},e.sent.flat().forEach(e.t0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e,t){return bt.apply(this,arguments)}function bt(){return(bt=Object(d.a)(h.a.mark((function e(t,n){var r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ft(n.notes,n.quotes);case 2:return r=e.sent,e.next=5,ft(n.backrefs);case 5:return a=e.sent,e.next=8,lt(t.topic.actionOn,a);case 8:return e.next=10,lt(t.topic.related,a);case 10:return e.next=12,lt(t.topic.broader,a);case 12:return a=a.sort(G),e.abrupt("return",{related:a,notes:r});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vt(){return(vt=Object(d.a)(h.a.mark((function e(t,n){var r,a,c,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dt(t,n);case 2:return r=e.sent,a=r.related,c=r.notes,e.t0={heading:"Related",list:a},e.next=8,xt(t.topic.links);case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1=[];case 11:if(e.t2=e.t1,e.t3={heading:"Links",list:e.t2},e.t4={heading:"Notes",list:c},e.t5=function(e){return e.list&&e.list.length>0},0!==(i=[e.t0,e.t3,e.t4].filter(e.t5)).length){e.next=18;break}return e.abrupt("return",[]);case 18:return e.abrupt("return",{divs:i});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(e,t){return mt.apply(this,arguments)}function mt(){return(mt=Object(d.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&0!==t.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all(t.map(function(){var e=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W(t)){e.next=2;break}return e.abrupt("return",t);case 2:if(!n||!n(t.ref)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.abrupt("return",wt(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:if(!((r=e.sent.flat()).length>0)){e.next=7;break}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(e){return kt.apply(this,arguments)}function kt(){return(kt=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se(t.ref);case 2:if(n=e.sent){e.next=7;break}return e.abrupt("return",{text:"Missing ".concat(t.ref)});case 7:if(!n.metadata.stale_at){e.next=11;break}return e.abrupt("return",[]);case 11:return e.abrupt("return",yt(n));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yt(e){return gt.apply(this,arguments)}function gt(){return(gt=Object(d.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.topic,r=t.metadata,!n.title){e.next=5;break}return e.abrupt("return",{ref:r.id,label:V(n)});case 5:if(n.text){e.next=9;break}return e.abrupt("return",{ref:r.id,label:V(n)});case 9:return e.t0=r.id,e.t1=n.text,e.next=13,Ot(n.src);case 13:return e.t2=e.sent,e.abrupt("return",{ref:e.t0,text:e.t1,src:e.t2});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ot(e){return jt.apply(this,arguments)}function jt(){return(jt=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!W(t)){e.next=11;break}return e.next=5,Se(t.ref);case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return","Missing ".concat(t.ref));case 8:return e.abrupt("return",{ref:t.ref,label:V(n.topic)});case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Et(e){var t=e.match.params.topicId,n=I(t,Ye);return a.a.createElement("div",{className:"topicPage"},a.a.createElement(o,null,a.a.createElement("li",null,a.a.createElement(u.b,{to:"/index"},"index")),a.a.createElement("li",null,a.a.createElement(u.b,{to:"/add_note/".concat(t)},"add note"))),n&&a.a.createElement(f,{title:n.title}),n&&n.sections.map((function(e,t){return a.a.createElement("section",{key:t},e.title&&a.a.createElement("h2",{className:"title"},e.title),e.text&&_t(e,!1),e.divs&&e.divs.map((function(e,t){return a.a.createElement("div",{key:t},e.heading&&a.a.createElement("h3",{className:"title"},e.heading),Pt(e.list))})))})))}function Pt(e){return a.a.createElement("ul",null,e.map((function(e,t){return a.a.createElement("li",{key:t},_t(e))})))}function _t(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e)return"string"===typeof e?e.startsWith("http")?St(e):a.a.createElement("p",null,e):e.text||!e.link&&!e.search?e.label?Dt(e.ref,e.label):a.a.createElement("p",null,e.text,e.src&&a.a.createElement("span",null," - ",(t=e.src)?"string"===typeof t?St({link:t,title:"src"}):t.ref?Dt(t.ref,t.label):a.a.createElement("pre",null,JSON.stringify(t)):void 0," "),n&&a.a.createElement("span",null," (",Dt(e.ref,"more","moreLink"),")")):St(e);throw new Error("item parameter is missing")}function St(e){var t=document.documentElement.clientWidth<800;if("string"===typeof e||e.link){var n=e,r=e;return"string"!==typeof e&&(n=e.link,r=e.title||e.link),r.startsWith("https://en.wikipedia.org/wiki")?r="Wikipedia: ".concat(r.replace("https://en.wikipedia.org/wiki/","").replace(/_/g," ")):-1!==r.indexOf("pinboard.in/u:curzonj/")&&(r="Pinboard: ".concat(r.replace(/https?:\/\/pinboard.in\/u:curzonj\//,"").split("/").filter((function(e){return""!==e})).flatMap((function(e){return e.replace(/^t:/,"")})).join(", ")),n=n.replace(/^http:\/\//,"https://"),t&&(n=n.replace("pinboard.in","m.pinboard.in"))),a.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n},r)}if(e.search)return a.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://google.com/search?q="+encodeURIComponent(e.search)},"Google: ",e.search)}function Dt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"refLink";return a.a.createElement(u.b,{className:n,to:encodeURI(e)},t||e)}var Nt=n(93),It=function(e){var t=e.handler,n=e.children,c=Object(Nt.a)(e,["handler","children"]),i=Object(r.useState)(""),u=Object(p.a)(i,2),s=u[0],f=u[1];function l(e){e.preventDefault(),P((function(){return t(s)}))}return a.a.createElement("div",c,a.a.createElement(o,null,a.a.createElement("li",null,a.a.createElement("button",{type:"button",className:"link-button",onClick:l},"done"))),n,a.a.createElement("form",null,a.a.createElement("textarea",{onKeyDown:function(e){13===e.which&&(e.metaKey||e.shiftKey)&&l(e)},autoComplete:"on",autoCapitalize:"sentences",required:!0,onChange:function(e){e&&e.target&&f(e.target.value)},value:s})))},At=function(e){var t=e.match.params.topicId,n=I(t,Se);function r(){return(r=Object(d.a)(h.a.mark((function n(r){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""===r.trim()){n.next=3;break}return n.next=3,Ne(t,r);case 3:e.history.push("/".concat(t));case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return a.a.createElement(It,{className:"topicPage",handler:function(e){return r.apply(this,arguments)}},n&&a.a.createElement(f,{title:V(n.topic)}))},Bt=n(94),Lt=n(95),zt=n.n(Lt),qt=n(45);function Wt(){var e=Object(Bt.a)(["\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  z-index: -1;\n"]);return Wt=function(){return e},e}var Ct=function(e){function t(){return(t=Object(d.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n,JSON.parse(r),localStorage.couchdb_target=r,Ce(),e.history.push("/index");case 2:case"end":return t.stop()}var r}),t)})))).apply(this,arguments)}return a.a.createElement(It,{handler:function(e){return t.apply(this,arguments)}},a.a.createElement("div",{className:"header"},a.a.createElement("h1",{className:"title"},"Enter the configuration")))},Tt=Object(qt.css)(Wt()),Rt=Object(s.i)((function(e){var t=Object(r.useState)(!1),n=Object(p.a)(t,2),c=n[0],i=n[1],u=Object(r.useState)(Oe.hasFired()),s=Object(p.a)(u,2),o=s[0],f=s[1];return o||Oe.once((function(e,t){return f(!0)})),c||"/login"===e.location.pathname||P(Object(d.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,qe();case 2:t.sent?i(!0):e.history.push("/login");case 4:case"end":return t.stop()}}),t)})))),a.a.createElement(zt.a,{css:Tt,widthUnit:"%",width:100,color:"rgb(54, 215, 183)",loading:!o})}));n(173);function Ft(e){return a.a.createElement("div",{className:"menuPage"},a.a.createElement(o,null,a.a.createElement("li",null,a.a.createElement(u.b,{to:"/index"},"index"))),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(u.b,{to:"/search"},"search")),a.a.createElement("li",null,a.a.createElement(u.b,{to:"/recent"},"recent"))))}n(174);function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(n,!0).forEach((function(t){Object(A.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jt(e){var t=Object(s.g)(),n=Object(s.h)(),c=new URLSearchParams(n.search).get("search"),i=Object(r.useState)(),f=Object(p.a)(i,2),l=f[0],b=f[1];N.trace({textValue:l,searchTerm:c});var v=I(c,function(){var e=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Ee.topics.idx.terms.getAll({gte:t,lt:[t,le].join("")});case 4:return n=e.sent,e.abrupt("return",ft(n.sort($)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{wait:200,leading:!0,fuzzy:!0});return a.a.createElement("div",{className:"searchPage"},a.a.createElement(o,null,a.a.createElement("li",null,a.a.createElement(u.b,{to:"/index"},"index"))),a.a.createElement("form",{onSubmit:function(e){N.uiEvents("onSubmit"),e.preventDefault()}},a.a.createElement("input",{placeholder:"Search for...",onChange:function(e){if(e&&e.target){var r=e.target.value.toLowerCase().trim();N.uiEvents("onChange value=%s",r),r.length>2?(t.replace(Mt({},n,{search:"?search=".concat(r)})),b(r)):(t.replace(Mt({},n,{search:""})),b(void 0))}}})),c&&v&&Pt(v))}function Kt(e){var t=Object(r.useState)(),n=Object(p.a)(t,2),c=n[0],i=n[1];return Object(r.useEffect)((function(){return P(Object(d.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee.topics.getAll();case 2:return t=e.sent,e.next=5,ft(t.sort($).slice(0,200));case 5:n=e.sent,i(n);case 7:case"end":return e.stop()}}),e)}))))})),a.a.createElement("div",{className:"recentPage"},a.a.createElement(o,null,a.a.createElement("li",null,a.a.createElement(u.b,{to:"/index"},"index"))),a.a.createElement(f,{title:"Recent Entries"}),c&&Pt(c))}var Vt=function(e){function t(){return Object(x.a)(this,t),Object(m.a)(this,Object(w.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(R.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.location.pathname!==e.location.pathname&&"nodejs"!==window.name&&window.scrollTo(0,0)}},{key:"render",value:function(){return this.props.children}}]),t}(a.a.Component),$t=Object(s.i)(Vt);function Gt(e){var t=Object(r.useState)(!1),n=Object(p.a)(t,2),c=n[0],i=n[1];return c?a.a.createElement(a.a.Fragment,null):(setTimeout((function(){return i(!0)}),e.duration||2e3),a.a.createElement("span",{className:"codeversion"},"7010648"))}var Ht=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Qt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(a.a.createElement((function(){return a.a.createElement(u.a,{basename:"/brain"},a.a.createElement(Rt,null),a.a.createElement(Gt,null),a.a.createElement($t,null,a.a.createElement(s.d,null,a.a.createElement(s.a,{from:"/",to:"/index",exact:!0}),a.a.createElement(s.b,{path:"/login",component:Ct}),a.a.createElement(s.b,{path:"/menu",component:Ft}),a.a.createElement(s.b,{path:"/search",component:Jt}),a.a.createElement(s.b,{path:"/recent",component:Kt}),a.a.createElement(s.b,{path:"/add_note/:topicId+",component:At}),a.a.createElement(s.b,{path:"/:topicId+",component:Et}))))}),null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/brain",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/brain","/service-worker.js");Ht?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Qt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Qt(t,e)}))}}()},36:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),a=n(10),c=n(24),i=n(18),u=n(23),s=n(35),o=function(e){function t(e,n){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(i.a)(t).call(this,""))).type=void 0,a.db=void 0,a.leveldown=void 0,a.handlers=void 0,a.handlers=n,a.type=n.type,a.db=e,a}return Object(u.a)(t,e),Object(a.a)(t,[{key:"_open",value:function(e,t){var n=this;this.db.open((function(e){if(e)return t(e);n.leveldown=n.handlers.down?n.handlers.down(n.db):n.db.db,t(void 0)}))}},{key:"_close",value:function(e){this.ifOpen(e,(function(t){return t.close(e)}))}},{key:"_get",value:function(e,t,n){var r=this;this.ifOpen(n,(function(a){return r.handlers.get?r.handlers.get(a,e,t,n):a.get(e,t,n)}))}},{key:"_put",value:function(e,t,n,r){var a=this;this.ifOpen(r,(function(c){return a.handlers.put(c,e,t,n,r)}))}},{key:"_del",value:function(e,t,n){var r=this;this.ifOpen(n,(function(a){return r.handlers.del(a,e,t,n)}))}},{key:"_batch",value:function(e,t,n){var r=this;this.ifOpen(n,(function(a){return r.handlers.batch(a,e,t,n)}))}},{key:"_iterator",value:function(e){if(void 0===this.leveldown)throw new Error("not open yet");return this.handlers.iterator?this.handlers.iterator(this,this.leveldown,e):this.leveldown.iterator(e)}},{key:"ifOpen",value:function(e,t){this.leveldown?t(this.leveldown):e(new Error("not open yet"))}}]),t}(s.AbstractLevelDOWN)},38:function(e,t,n){"use strict";(function(e){var r=n(24),a=n(18),c=n(23),i=n(5),u=n(10),s=n(91),o=n.n(s),f=n(35),p=n(36),l=function(){function t(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(i.a)(this,t),this.type="sublevel",this.prefix=void 0,this._wrapper=void 0,this.prefix=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"!";e[0]===t&&(e=e.slice(1));e[e.length-1]===t&&(e=e.slice(0,-1));return t+e+t}(r,a.separator),this._wrapper=function(t){return{gt:function(e){return m(t(),e||"",!0)},lt:function(n){return e.isBuffer(n)?(n.length||(n=v),m(t(),n)):m(t(),n||x)}}}((function(){return n.prefix}))}return Object(u.a)(t,[{key:"down",value:function(e){var t=w(e,this.type);return t&&t.prefix?(this.prefix=t.prefix+this.prefix,w(t.db)):w(e)}},{key:"get",value:function(e,t,n,r){e.get(m(this.prefix,t),n,r)}},{key:"put",value:function(e,t,n,r,a){e.put(m(this.prefix,t),n,r,a)}},{key:"del",value:function(e,t,n,r){e.del(m(this.prefix,t),n,r)}},{key:"batch",value:function(e,t,n,r){for(var a=0;a<t.length;a++)t[a].key=m(this.prefix,t[a].key);e.batch(t,n,r)}},{key:"iterator",value:function(e,t,n){var r,a=function(e,t){for(var n in t)Object.hasOwnProperty.call(t,n)&&!b(n)&&(e[n]=t[n]);return e}(o()((r=n).reverse&&(r.end||r.start)?{start:r.end,end:r.start}:r,this._wrapper),n);return new h(e,t.iterator(a),this.prefix)}}]),t}(),h=function(e){function t(e,n,c){var u;return Object(i.a)(this,t),(u=Object(r.a)(this,Object(a.a)(t).call(this,e))).iterator=void 0,u.prefix=void 0,u.iterator=n,u.prefix=c,u}return Object(c.a)(t,e),Object(u.a)(t,[{key:"_next",value:function(e){var t=this;this.iterator.next((function(n,r,a){if(n)return e(n);r&&(r=r.slice(t.prefix.length)),e(n,r,a)}))}},{key:"_seek",value:function(e){this.iterator.seek(m(this.prefix,e))}},{key:"_end",value:function(e){this.iterator.end(e)}}]),t}(f.AbstractIterator);var d="start end gt gte lt lte".split(" ");function b(e){return-1!==d.indexOf(e)}var v=e.from([255]),x="\xff";function m(t,n){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&!n.length)return n;if("string"===typeof n)return t+n;if(e.isBuffer(n))return e.concat([e.from(t),n]);throw new Error("key must be a string or a buffer")}function w(e,t){return"function"===typeof e.down?e.down(t):t&&e.type===t?e:k(e.db)?w(e.db,t):k(e._db)?w(e._db,t):t?void 0:e}function k(e){return!(!e||"object"!==typeof e)&&("function"===typeof e._batch&&"function"===typeof e._iterator)}t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new p.a(e,new l(t,n))}}).call(this,n(7).Buffer)},92:function(e,t,n){"use strict";(function(e){var r=n(0),a=n.n(r),c=n(2),i=n(5),u=n(10),s=n(36),o=function(){function t(e){Object(i.a)(this,t),this.type="batch",this.base=void 0,this.operations=void 0,this.base=e,this.operations=[]}return Object(u.a)(t,[{key:"write",value:function(){var e=Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.operations.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.operations,this.operations=[],e.next=6,this.base.batch(t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"put",value:function(t,n,r,a,c){a&&!0===a.writeBatch?t.put(n,r,a,c):(this.operations.push({type:"put",key:n,value:r}),c&&e.nextTick(c))}},{key:"del",value:function(t,n,r,a){r&&!0===r.writeBatch?t.del(n,r,a):(this.operations.push({type:"del",key:n}),a&&e.nextTick(a))}},{key:"batch",value:function(t,n,r,a){var c=this;r&&!0===r.writeBatch?t.batch(n,r,a):(n.forEach((function(e){return c.operations.push(e)})),a&&e.nextTick(a))}}]),t}();t.a=function(e){var t=new o(e);return{db:new s.a(e,t),write:function(){return t.write()}}}}).call(this,n(3))},98:function(e,t,n){e.exports=n(175)}},[[98,1,2]]]);
//# sourceMappingURL=main.2a5e7af0.chunk.js.map